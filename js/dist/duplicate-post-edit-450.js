(()=>{"use strict";var e={18(e){e.exports=window.wp.components},230(e){e.exports=window.wp.element},328(e){e.exports=window.wp.editPost},380(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.redirectOnSaveCompletion=void 0;var r=i(454),o=function(e){var t=(0,r.select)("core/editor").getCurrentPostAttribute("status"),i=(0,r.select)("core/editor").getEditedPostAttribute("status");"dp-rewrite-republish"===t&&"publish"===i&&(0,r.dispatch)("core/editor").editPost({status:t}),window.location.assign(e)};t.redirectOnSaveCompletion=function(e,t){var i=(0,r.select)("core/editor").isSavingPost(),n=(0,r.select)("core/editor").isAutosavingPost(),s=(0,r.select)("core/edit-post").hasMetaBoxes(),a=(0,r.select)("core/edit-post").isSavingMetaBoxes();return s&&!a&&t.wasSavingMetaboxes&&o(e),s||i||!t.wasSavingPost||t.wasAutoSavingPost||o(e),{isSavingPost:i,isSavingMetaBoxes:a,isAutosavingPost:n}}},454(e){e.exports=window.wp.data},754(e){e.exports=window.wp.i18n},910(e){e.exports=window.wp.plugins}},t={};function i(r){var o=t[r];if(void 0!==o)return o.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,i),n.exports}var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],r=!0,o=!1,n=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(i.push(s.value),!t||i.length!==t);r=!0);}catch(e){o=!0,n=e}finally{try{!r&&a.return&&a.return()}finally{if(o)throw n}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),n=i(910),s=i(328),a=i(230),u=i(18),l=i(754),c=i(454),p=i(380),d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.renderNotices(),this.removeSlugSidebarPanel()}return o(e,[{key:"handleRedirect",value:function(){var e=this;if(parseInt(duplicatePost.rewriting,10)){var t=!1,i=!1,r=!1;(0,c.subscribe)(function(){if(e.isSafeRedirectURL(duplicatePost.originalEditURL)&&e.isCopyAllowedToBeRepublished()){var o=(0,p.redirectOnSaveCompletion)(duplicatePost.originalEditURL,{wasSavingPost:t,wasSavingMetaboxes:i,wasAutoSavingPost:r});t=o.isSavingPost,i=o.isSavingMetaBoxes,r=o.isAutosavingPost}})}}},{key:"isSafeRedirectURL",value:function(e){var t=document.createElement("a");return t.href=e,!!(/^https?:$/.test(t.protocol)&&/\/wp-admin\/post\.php$/.test(t.pathname)&&/\?action=edit&post=[0-9]+&dprepublished=1&dpcopy=[0-9]+&dpnonce=[a-z0-9]+/i.test(t.search))}},{key:"isCopyAllowedToBeRepublished",value:function(){var e=(0,c.select)("core/editor").getCurrentPostAttribute("status");return"dp-rewrite-republish"===e||"private"===e}},{key:"renderNotices",value:function(){if(duplicatePostNotices&&duplicatePostNotices instanceof Object){var e=!0,t=!1,i=void 0;try{for(var o,n=Object.entries(duplicatePostNotices)[Symbol.iterator]();!(e=(o=n.next()).done);e=!0){var s=o.value,a=r(s,2),u=(a[0],a[1]);u.status&&u.text&&(0,c.dispatch)("core/notices").createNotice(u.status,u.text,{isDismissible:u.isDismissible||!0})}}catch(e){t=!0,i=e}finally{try{!e&&n.return&&n.return()}finally{if(t)throw i}}}}},{key:"removeSlugSidebarPanel",value:function(){parseInt(duplicatePost.rewriting,10)&&(0,c.dispatch)("core/edit-post").removeEditorPanel("post-link")}},{key:"render",value:function(){if(!(0,c.select)("core/editor")||!wp.editPost||!wp.editPost.PluginPostStatusInfo)return null;var e=(0,c.select)("core/editor").getEditedPostAttribute("status");return"1"===duplicatePost.showLinksIn.submitbox&&wp.element.createElement(a.Fragment,null,""!==duplicatePost.newDraftLink&&"1"===duplicatePost.showLinks.new_draft&&wp.element.createElement(s.PluginPostStatusInfo,null,wp.element.createElement(u.Button,{isTertiary:!0,className:"dp-editor-post-copy-to-draft",href:duplicatePost.newDraftLink},(0,l.__)("Copy to a new draft","duplicate-post"))),"publish"===e&&""!==duplicatePost.rewriteAndRepublishLink&&"1"===duplicatePost.showLinks.rewrite_republish&&wp.element.createElement(s.PluginPostStatusInfo,null,wp.element.createElement(u.Button,{isTertiary:!0,className:"dp-editor-post-rewrite-republish",href:duplicatePost.rewriteAndRepublishLink},(0,l.__)("Rewrite & Republish","duplicate-post"))))}}]),e}(),w=new d;w.handleRedirect(),(0,n.registerPlugin)("duplicate-post",{render:w.render})})();